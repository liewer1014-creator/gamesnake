#include <Wire.h>
#include <LiquidCrystal_I2C.h>

// -------------------------------
// MQ-136 Gas Sensor + 2 LED Example
// -------------------------------

LiquidCrystal_I2C lcd(0x27, 16, 2);  // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡∏≠‡∏á‡∏à‡∏≠ I2C (‡∏ö‡∏≤‡∏á‡∏£‡∏∏‡πà‡∏ô‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô 0x27 ‡∏´‡∏£‡∏∑‡∏≠ 0x3F)


int mq136Pin = A0;       // ‡∏Ç‡∏≤ A0 ‡∏Ç‡∏≠‡∏á‡πÄ‡∏ã‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå
int ledGreen = 12;       // ‡∏Ç‡∏≤‡πÑ‡∏ü‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß
int ledRed = 13;         // ‡∏Ç‡∏≤‡πÑ‡∏ü‡πÅ‡∏î‡∏á

int sensorValue = 0;     // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå
float voltage = 0;       // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÑ‡∏ü‡∏ü‡πâ‡∏≤
int threshold = 400;     // ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ß‡πà‡∏≤ "‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏Å‡πä‡∏≤‡∏ã" (‡∏õ‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)

void setup() {
  Serial.begin(9600);
  pinMode(ledGreen, OUTPUT);
  pinMode(ledRed, OUTPUT);

  // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏à‡∏≠ LCD
  lcd.init();
  lcd.backlight();

  lcd.setCursor(0, 0);
  lcd.print("MQ-136 Gas Sensor");
  lcd.setCursor(0, 1);
  lcd.print("Starting...");
  delay(2000);
  lcd.clear();
}

void loop() {
  sensorValue = analogRead(mq136Pin);
  voltage = sensorValue * (5.0 / 1023.0);

  Serial.print("Analog Value : ");
  Serial.print(sensorValue);
  Serial.print("\tVoltage : ");
  Serial.println(voltage);

  if (sensorValue > threshold) {
    // üî¥ ‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏Å‡πä‡∏≤‡∏ã
    digitalWrite(ledRed, HIGH);
    digitalWrite(ledGreen, LOW);

    lcd.clear();
    lcd.setCursor(0, 0);
    lcd.print("Gas Detected!");
    lcd.setCursor(0, 1);
    lcd.print("Value: ");
    lcd.print(sensorValue);

    Serial.println("‚ö†Ô∏è ‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏Å‡πä‡∏≤‡∏ã H2S ‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô!");
  } else {
    // üü¢ ‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏õ‡∏Å‡∏ï‡∏¥
    digitalWrite(ledRed, LOW);
    digitalWrite(ledGreen, HIGH);

    lcd.clear();
    lcd.setCursor(0, 0);
    lcd.print("Air Normal :)");
    lcd.setCursor(0, 1);
    lcd.print("Value: ");
    lcd.print(sensorValue);

    Serial.println("‚úÖ ‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏õ‡∏Å‡∏ï‡∏¥ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏Å‡πä‡∏≤‡∏ã");
  }

  delay(1000);
}
